"""
These are institutions that are partnered with Shuddhi Vidhya
These could be schools, colleges, corporates, organisations etc.
They contain information like name, website, who the admins are,
what classes/departments they contain
"""
type Institution @model {
  id: ID!
  "Name of the institution"
  name: String!
  "Location of the institution"
  location: String!
  "City or district that the institution belongs to"
  city: String!
  "Website URL"
  website: String
  "Phone number"
  phone: String
  "Logo url"
  logo: String
  "Short bio, could be their school motto"
  bio: String
  "admins of the institution manage the institution's properties"
  admins: [InstitutionAdmin]
  "Fundamental units of learners belonging to the institution"
  classes: [Class] @connection(name: "InstitutionClassesConnection")
  "All learners belonging to the institution"
  learners: [Learner] @connection(name: "InstititionMembersConnection")
}

"""
Fundamental units of learners in the institution that this unit belongs to
"""
type Class
  @model
  @auth(
    rules: [{ allow: owner, ownerField: "admins", operations: [update, read] }]
  ) {
  id: ID!
  "name of the class"
  name: String!
  "The id of the insitition that this class belongs to"
  institution: Institution @connection(name: "InstitutionClassesConnection")
  "The admins of the class who can manage members of the class etc"
  admins: [ClassAdmin]
  "Includes all the members of the class - learners, admins etc"
  learners: [Learner] @connection(name: "ClassMembersConnection")
}

"""
Groups of students other than classes.
These are more volatile grouping than classes are.
"""
type Group
  @model
  @auth(
    rules: [{ allow: owner, ownerField: "admins", operations: [update, read] }]
  ) {
  id: ID!
  "name of the group"
  name: String!
  "The id of the insitition that this group belongs to"
  institution: Institution @connection(name: "InstitutionClassesConnection")
  "The admins of the group who can manage members of the class etc"
  admins: [Learner]
  "List of members in this group"
  learners: [Learner]
}

"""
Learners table, contains all individuals who are consumers of the course content
"""
type Learner @model @auth(rules: [{ allow: owner }]) {
  id: ID!
  "Name of the individual"
  name: String!
  "Id of the institution that this individual belongs to"
  institution: Institution! @connection(name: "InstititionMembersConnection")
  "Id of the class of the institution in which the member is part of"
  class: Class @connection(name: "ClassMembersConnection")
}

"""
Institution admins table, contains the admins of institution
"""
type InstitutionAdmin @model @auth(rules: [{ allow: owner }]) {
  id: ID!
  "Name of the individual"
  name: String!
  "Id of the institution that this admin belongs to"
  institution: Institution!
  "This is a description to be shown on their profile"
  title: String
  "This is the bio of the institution admin"
  bio: String
}

"""
Class admins table, contains the admins of class
"""
type ClassAdmin @model @auth(rules: [{ allow: owner }]) {
  id: ID!
  "Name of the individual"
  name: String!
  "Id of the institution that this admin belongs to"
  institution: Institution!
  "Id of the class of the institution in which the member is part of"
  class: Class
  "This is a description to be shown on their profile"
  title: String
  "This is the bio of the institution admin"
  bio: String
}

"""
Courses are created by instructors
"""
type Course
  @model
  @auth(
    rules: [
      { allow: owner, ownerField: "instructor", operations: [update, read] }
    ]
  ) {
  id: ID!
  "Instructor of the course"
  instructor: Instructor @connection(name: "CourseInstructorConnection")
  "those who will be assisting with the course"
  assistant: [CourseAssistant] @connection(name: "CourseAssistantConnection")
  "When the course starts"
  start: AWSDate
  "When the course is expected to end"
  end: AWSDate
  "Number of hours the learners are expected to invest per week"
  creditHours: Int
  "assignments as part of this course"
  assignments: [Assignment]
  "sections in the course"
  sections: [CourseSection]
}

"""
CourseSections belong to courses and contain assignments
"""
type CourseSection @model {
  id: ID!
  "Name of the section"
  name: String!
  "Section number"
  index: Float!
  "Course that this section belongs to"
  course: Course!
}

"""
Assignments are part of courses and need to be completed as part of the course
"""
type Assignment @model {
  id: ID!
  "Title of the assignment"
  title: String!
  "Id of the course that this assignment belongs to"
  course: Course!
  "Id of the section that this assignment belongs to"
  section: CourseSection!
  "When this assignment is due"
  deadline: AWSDateTime
  "Total number of points available to score in this assignment"
  points: Int
  "A description of what needs to be done in the assignment"
  instructions: String
  "A list of tasks to be completed as part of this assignment"
  tasks: [Task]
}

"""
Tasks to be completed as part of an assignment
INCOMPLETE
"""
type Task @model {
  id: ID!
  "Description of the task"
  task: String!
  "An enum of the fixed list of types of tasks"
  type: String!
}

"""
Instructors are responsible for creating and managing courses
"""
type Instructor @model @auth(rules: [{ allow: owner }]) {
  id: ID!
  "Name of the instructor"
  name: String!
  "Title of the instructor"
  title: String
  "Instructor's self-description"
  courses: [Course] @connection(name: "CourseInstructorConnection")
}

"""
Assistants are meant to assist the instructors with conducting the course
Assistants can have a look at the questions asked by the learners of the course
and they can assist with grading. They have all the access that the instructor has
"""
type Assistant @model @auth(rules: [{ allow: owner }]) {
  id: ID!
  "name of the assistant"
  name: String!
  "List of courses they are assisting for"
  course: [CourseAssistant] @connection(name: "AssistantCourseConnection")
}
"""
This is a join table that ties courses with Assistants
This is the way to establish many-to-many relationships
"""
type CourseAssistant @model {
  id: ID!
  "The course that this assistant belongs to"
  course: Course @connection(name: "CourseAssistantConnection")
  "The assistants that are in a course"
  assistant: Assistant @connection(name: "AssistantCourseConnection")
}
